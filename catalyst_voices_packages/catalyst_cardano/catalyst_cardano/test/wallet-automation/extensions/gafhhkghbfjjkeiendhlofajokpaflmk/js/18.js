"use strict";(self["webpackChunk_lace_browser_extension_wallet"]=self["webpackChunk_lace_browser_extension_wallet"]||[]).push([[18],{68573:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"6f67e09126f1f0f636629f6d8be36aea.svg"},4052:(e,t,a)=>{a.d(t,{C:()=>AssetsCounter});var n=a(14041);var r=a(4531);const AssetsCounter=({count:e})=>n.createElement("div",{className:r.A.container,"data-testid":"assets-counter"},n.createElement("p",null,e))},44470:(e,t,a)=>{a.d(t,{I:()=>SelectTokenButton});var n=a(14041);var r=a(68350);var s=a(4052);var o=a(86004);const SelectTokenButton=({label:e,onClick:t,count:a=0,btnStyle:l,testId:c})=>n.createElement("div",{className:o.A.container},a>0&&n.createElement(s.C,{count:a}),n.createElement(r.Button,{"data-testid":c,style:l,onClick:t,color:"secondary",variant:"outlined",className:o.A.selectMultipleBtn},e))},51314:(e,t,a)=>{a.d(t,{v:()=>n.v});var n=a(92185)},91456:(e,t,a)=>{a.d(t,{Y:()=>n.Y});var n=a(7857)},30037:(e,t,a)=>{a.d(t,{ef:()=>l.ef});var n=a(14041);var r=a(45636);var s=a(5218);var o=a(82443);var l=a(99004)},62055:(e,t,a)=>{a.d(t,{m:()=>UnlockWallet});var n=a(14041);var r=a(45636);var s=a(68573);var o=a(68350);var l=a(63916);var c=a(22857);var i=a(5218);var d=a(18576);const UnlockWallet=({onUnlock:e,onForgotPasswordClick:t,passwordInput:a,unlockButtonDisabled:u,showForgotPassword:v=true})=>{const{t:m}=(0,i.useTranslation)();return n.createElement(r.s7,null,n.createElement("form",{onSubmit:e,className:c.A.lockWalletContent},n.createElement("div",{className:c.A.content,"data-testid":"unlock-screen"},n.createElement("img",{src:s.A,alt:"LACE",className:c.A.image,"data-testid":"unlock-screen-img"}),n.createElement("h1",{className:c.A.title,"data-testid":"unlock-screen-title"},m("unlock.sectionTitle")),n.createElement(l.Password,{errorMessage:m("general.errors.invalidPassword"),error:a.invalidPass,onChange:a.handleChange,onPressEnter:t=>{t.preventDefault();e()},label:m("unlock.input.placeholder")})),n.createElement("div",{className:c.A.blockButton},n.createElement(o.Button,{color:"gradient",onClick:e,disabled:u,"data-testid":"unlock-button"},m("unlock.button"))),v&&n.createElement(d.X,{onForgotPasswordClick:t})))}},17270:(e,t,a)=>{a.d(t,{Ss:()=>n.Ss,h8:()=>n.h8});var n=a(85979)},79391:(e,t,a)=>{a.d(t,{N:()=>UIThemeProvider});var n=a(14041);var r=a(80003);var s=a.n(r);var o=a(29284);const UIThemeProvider=({children:e})=>{const{theme:t}=(0,o.D)();return n.createElement(r.ThemeProvider,{colorScheme:"light"===t.name?r.ThemeColorScheme.Light:r.ThemeColorScheme.Dark},e)}},82340:(e,t,a)=>{var n=a(14041);var r=a(63916);var s=a(68350);var o=a(5218);var l=a(72591);var c=a.n(l);var i=a(1740);var d=a.n(i);var u=a(88128);var v=a.n(u);var m=a(30855);var f=a.n(m);var S=a(93051);var w=a.n(S);var h=a(73656);var g=a.n(h);var A=a(88901);var E={};E.styleTagTransform=g();E.setAttributes=f();E.insert=v().bind(null,"head");E.domAPI=d();E.insertStyleElement=w();var p=c()(A.A,E);A.A&&A.A.locals&&A.A.locals;var C=a(29284);var T=a(34671);var b=a(6285);var _=a(72165);var k=a(19065);var Z=a(79457);var N=a(69777);var y=a(45636);var I=a(93750);var x=a(45874);var D={};D.styleTagTransform=g();D.setAttributes=f();D.insert=v().bind(null,"head");D.domAPI=d();D.insertStyleElement=w();var M=c()(x.A,D);x.A&&x.A.locals&&x.A.locals;var V=a(76647);var F=a(85498);var R=a(14024);var P=a(41926);var O=a(93055);var H=a(40228);var L=a(56830);var W=a(64815);var B=a(42509);var U=a(45026);var X={};X.styleTagTransform=g();X.setAttributes=f();X.insert=v().bind(null,"head");X.domAPI=d();X.insertStyleElement=w();var G=c()(U.A,X);U.A&&U.A.locals&&U.A.locals;var z=a(95623);var Y=a(97177);var j=a(7502);var K=a(37769);var J=a(76306);var $=a(65711);var Q=a(52033);var q=a(39260);var ee={};ee.styleTagTransform=g();ee.setAttributes=f();ee.insert=v().bind(null,"head");ee.domAPI=d();ee.insertStyleElement=w();var et=c()(q.A,ee);q.A&&q.A.locals&&q.A.locals;var ea=a(15937);var en=a(7071);var er=a(74355);var es=a(31562);var eo=a(60986);var el=a(82513);var ec=a(11226);var ei=a(27085);var ed=a(70106);var eu=a(75004);var ev=a(79324);var em=a(13303);var ef=a(53046);var eS=a(41871);var ew=a(74103);var eh,eg;function expand_gradient_component_extends(){expand_gradient_component_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n))e[n]=a[n]}return e};return expand_gradient_component_extends.apply(this,arguments)}var SvgExpandGradientcomponent=function(e){return React.createElement("svg",expand_gradient_component_extends({width:"1em",height:"1em",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),eh||(eh=React.createElement("path",{d:"M3.5 8a1 1 0 0 0 2 0h-2Zm1-4V3a1 1 0 0 0-1 1h1Zm4 1a1 1 0 0 0 0-2v2Zm11 3a1 1 0 1 0 2 0h-2Zm1-4h1a1 1 0 0 0-1-1v1Zm-4-1a1 1 0 1 0 0 2V3Zm-11 13a1 1 0 1 0-2 0h2Zm-1 4h-1a1 1 0 0 0 1 1v-1Zm4 1a1 1 0 1 0 0-2v2Zm1.707-5.293a1 1 0 0 0-1.414-1.414l1.414 1.414Zm4.586-7.414a1 1 0 0 0 1.414 1.414l-1.414-1.414Zm-6 1.414a1 1 0 0 0 1.414-1.414L8.793 9.707ZM20.5 20v1a1 1 0 0 0 1-1h-1Zm-4.293-5.707a1 1 0 0 0-1.414 1.414l1.414-1.414ZM21.5 16a1 1 0 1 0-2 0h2Zm-5 3a1 1 0 1 0 0 2v-2ZM5.5 8V4h-2v4h2Zm-1-3h4V3h-4v2Zm17 3V4h-2v4h2Zm-1-5h-4v2h4V3Zm-17 13v4h2v-4h-2Zm1 5h4v-2h-4v2Zm.707-.293 5-5-1.414-1.414-5 5 1.414 1.414Zm11-11 5-5-1.414-1.414-5 5 1.414 1.414Zm-6-1.414-5-5-1.414 1.414 5 5 1.414-1.414Zm11 11-5-5-1.414 1.414 5 5 1.414-1.414ZM19.5 16v4h2v-4h-2Zm1 3h-4v2h4v-2Z",fill:"url(#expand-gradient_component_svg__a)"})),eg||(eg=React.createElement("defs",null,React.createElement("linearGradient",{id:"expand-gradient_component_svg__a",x1:1.572,y1:1.072,x2:25.014,y2:2.801,gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#FF92E1"}),React.createElement("stop",{offset:1,stopColor:"#FDC300"})))))};var eA=a(8125);var eE={};eE.styleTagTransform=g();eE.setAttributes=f();eE.insert=v().bind(null,"head");eE.domAPI=d();eE.insertStyleElement=w();var ep=c()(eA.A,eE);eA.A&&eA.A.locals&&eA.A.locals;const{Text:eC}=ef.A;var eT=a(51314);new Set([ev.Z.CONFIRMATION,ev.Z.SIGN,ev.Z.FAIL_TX,ev.Z.SUCCESS_TX]);new Set([ev.Z.CONFIRMATION,ev.Z.SIGN]);new Set([ev.Z.DETAIL,ev.Z.CONFIRMATION,ev.Z.SIGN]);var eb=a(27739);var e_=a(64219);var ek=a(74342);var eZ=a(91456);var eN=a(53306);var ey=a(3705);var eI=a(9499);var ex=a(9189);var eD=a(91616);const eM="popupAddressBookContainerId";(0,e_.fd)(()=>{var e,t,a,l;const[c,i]=(0,n.useState)(false);const{list:d,count:u,utils:v}=(0,e_.ye)();const{extendLimit:m,deleteRecord:f}=v;const{setIsEditAddressVisible:S,isEditAddressVisible:w,setAddressToEdit:h,addressToEdit:g}=(0,eZ.Y)();const{t:A}=(0,o.useTranslation)();const E=(0,T.pn)();const p=(0,_.cz)();const C=(0,_.BM)(d,p);const{onSaveAddressActions:k}=(0,_.iF)();const{setSection:Z}=(0,P.WG)();const N={name:A("core.walletAddressList.name"),address:A("core.walletAddressList.address")};const onAddressSave=e=>k(e,g);var I;const x=(0,n.useMemo)(()=>{return(null==d?void 0:d.map(e=>{var t;return{id:e.id,address:e.address,name:e.name,onClick:e=>{var t;E.sendEventToPostHog(b.hs.AddressBookAddressRecordClick);h(e);if(eD.I&&(null===(t=C[e.address])||void 0===t?void 0:t.isValid)===false)i(true);else S(true)},isSmall:true,isAddressWarningVisible:null!==(I=eD.I&&(null===(t=C[e.address])||void 0===t?void 0:t.isValid)===false)&&void 0!==I&&I}}))||[]},[d,E,h,S,C]);const D=(0,n.useCallback)(()=>{m()},[m]);const handleAddAddressClick=()=>{S(true);E.sendEventToPostHog(b.hs.AddressBookAddAddressClick)};const M=(null==g?void 0:g.id)?ex.Q.DETAILS:ex.Q.CREATE;const onHandleDeleteContact=e=>{f(e,{text:A("browserView.addressBook.toast.deleteAddress"),icon:ey.A});h({})};var V,F;return n.createElement(n.Fragment,null,n.createElement(y.s7,{title:n.createElement("div",{className:eN.A.title},n.createElement("h1",{"data-testid":"page-title"},A("addressBook.sectionTitle")," ",n.createElement("span",{className:eN.A.subTitle,"data-testid":"counter"},"(",u,")"))),id:eM},n.createElement("div",{className:eN.A.btnContainer},n.createElement(s.Button,{"data-testid":"add-address-button",color:"gradient",block:true,onClick:handleAddAddressClick},n.createElement("img",{src:eI.A,alt:"plus-icon"}),A("addressBook.empty.addNewAddress"))),0===u?n.createElement("div",{className:eN.A.emptyScreen,"data-testid":"empty-address-book"},n.createElement(eb.t,null)):n.createElement("div",{className:eN.A.listContainer,"data-testid":"address-book-list"},n.createElement(r.WalletAddressList,{scrollableTargetId:eM,className:eN.A.addressList,items:x,loadMoreData:D,locale:{emptyText:true},total:u,withHeader:false,popupView:true,translations:N}))),eD.I&&n.createElement(ek.t,{visible:c,onCancelClick:()=>{h({});i(false);Z({currentSection:P.Z_.FORM})},expectedAddress:null!==(V=null===(e=C[g.address])||void 0===e?void 0:null===(t=e.error)||void 0===t?void 0:t.expectedAddress)&&void 0!==V?V:"",actualAddress:null!==(F=null===(a=C[g.address])||void 0===a?void 0:null===(l=a.error)||void 0===l?void 0:l.actualAddress)&&void 0!==F?F:"",initialValues:g,popupView:true}),n.createElement(ek.Z,{initialStep:M,initialValues:g,onCancelClick:()=>{h({});S(false)},onConfirmClick:async e=>{await onAddressSave(e);h({})},onDelete:e=>onHandleDeleteContact(e),visible:w,popupView:true}))});var eV=a(30037);var eF=a(75857);var eR=a.n(eF);var eP=a(3668);var eO=a.n(eP);var eH=a(85164);var eL=a(97629);var eW=a(5735);var eB=a(53962);var eU=a(26599);var eX=a(20684);var eG=a(87660);var ez=a(22953);var eY=a(80003);var ej=a(49101);var eK=a(41512);const eJ=10;(0,eU.Ko)(()=>{const e=(0,_.ml)(k.pZ.nftDetail);const[t,a]=(0,n.useState)(false);const{environmentName:l}=(0,Z.Gf)();const[c,i]=(0,n.useState)();const{walletInfo:d,inMemoryWallet:u}=(0,Z.Gf)();const{t:v}=(0,o.useTranslation)();const m=(0,_.s9)();const{isSearching:f,handleSearch:S,filteredResults:w}=(0,eK.E)(m);const h=(0,s.useObservable)(u.balance.utxo.total$,ea.ly.utxo.total$);const g=(0,T.pn)();const{fiatCurrency:A}=(0,T.cn)();const[E,p]=(0,n.useState)();const[C,N]=(0,n.useState)();const[I,x]=(0,n.useState)(false);const[D,M]=(0,n.useState)(false);const{utils:{deleteRecord:F}}=(0,eU.zH)();const[R,P]=(0,n.useState)("");const[O,H]=(0,n.useState)(false);const L=(0,n.useCallback)(t=>{g.sendEventToPostHog(b.hs.NFTsImageClick);e({params:{id:t.assetId.toString()}})},[g,e]);const W=(0,n.useMemo)(()=>{const{nftList:e}=(0,eL.iM)({assetsInfo:m,balance:null==h?void 0:h.assets,environmentName:l,fiatCurrency:A});return e.map(e=>({...e,type:r.NftsItemsTypes.NFT,onClick:()=>L(e)}))},[null==h?void 0:h.assets,m,l,A,L]);const B=(0,n.useCallback)((e,t)=>[{label:v("browserView.nfts.contextMenu.rename"),onClick:()=>{x(true);p({id:e,name:t})}},{label:v("browserView.nfts.contextMenu.delete"),onClick:()=>{N(e);M(true)}}],[v]);const{list:U}=(0,eU.zH)();const X=(0,n.useMemo)(()=>{return(null==U?void 0:U.map(({name:e,assets:t,id:n})=>({id:n,name:e,type:r.NftsItemsTypes.FOLDER,nfts:t.map(e=>W.find(({assetId:t})=>t.toString()===e)).filter(e=>!!e),contextMenuItems:B(n,e),onClick:()=>{i(n);a(true)}})))||[]},[U,W,B]);const G=(0,n.useMemo)(()=>X.find(({id:e})=>c===e),[c,X]);const z=eR()(null==U?void 0:U.map(({assets:e})=>e));const Y=W.filter(({assetId:e})=>!z.includes(e));const j=[...X,...Y];const K=eO()(h)||eO()(U);const onDeleteFolderConfirm=()=>{M(false);F(C,{text:v("browserView.nfts.deleteFolderSuccess"),icon:ez.A})};const J=(0,n.useCallback)(()=>{a(false);i(void 0)},[]);const handleNftSearch=(e,t)=>{P(t);if(!O){g.sendEventToPostHog(b.hs.NFTsSearchType);H(true)}S(e,t)};return n.createElement(n.Fragment,null,n.createElement(y.s7,{title:n.createElement("div",{className:eH.A.sectionTitle},n.createElement(Q._,{classname:eH.A.title,title:v("browserView.nfts.pageTitle"),sideText:`(${W.length})`,isPopup:true}),W.length>0&&true&&n.createElement(s.Button,{className:eH.A.newFolderBtn,color:"gradient",onClick:()=>{a(true);g.sendEventToPostHog(b.hs.NFTsCreateFolderClick)},"data-testid":"create-folder-button"},n.createElement(eW.A,{className:eH.A.newFolderIcon}))),isLoading:K,mainClassName:eH.A.nftsLayout},n.createElement("div",{className:eH.A.nfts},n.createElement("div",{className:eH.A.content,"data-testid":"nft-list-container"},j.length>0?n.createElement(n.Fragment,null,j.length>=eJ&&n.createElement(eY.SearchBox,{placeholder:v("browserView.nfts.searchPlaceholder"),onChange:e=>handleNftSearch(W,e),"data-testid":"nft-search-input",value:R,onClear:()=>P("")}),n.createElement(ej.A,{loading:f},""!==R&&w.length>0&&n.createElement(r.NftList,{items:w,rows:2}),""!==R&&0===w.length&&n.createElement(r.ListEmptyState,{message:v("core.assetSelectorOverlay.noMatchingResult"),icon:"sad-face"}),""===R&&n.createElement(r.NftList,{items:j,rows:2}))):n.createElement(V.h_,{title:v("browserView.nfts.fundWalletBanner.title"),prompt:v("browserView.nfts.fundWalletBanner.prompt"),walletAddress:d.addresses[0].address.toString()}))),n.createElement(eB.i,{selectedFolder:G,onSelectNft:L,visible:t,onClose:J,isPopupView:true}),n.createElement(eX.A,{folderToRename:E,visible:I,onClose:()=>x(false),isPopupView:true})),n.createElement(eG.d,{onCancel:()=>M(false),visible:D,title:v("browserView.nfts.deleteFolderModal.header"),description:n.createElement(n.Fragment,null,n.createElement("div",null,v("browserView.nfts.deleteFolderModal.description1")),n.createElement("div",{className:"mt-3"},v("browserView.nfts.deleteFolderModal.description2"))),actions:[{body:v("browserView.nfts.deleteFolderModal.cancel"),dataTestId:"delete-folder-modal-cancel",color:"secondary",onClick:()=>M(false)},{dataTestId:"delete-folder-modal-confirm",onClick:onDeleteFolderConfirm,body:v("browserView.nfts.deleteFolderModal.confirm")}]}))});var e$=a(86090);var eQ=a(95514);var eq=a(90604);function NftDetail_extends(){NftDetail_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n))e[n]=a[n]}return e};return NftDetail_extends.apply(this,arguments)}(0,eU.Ko)(()=>{var e;const{inMemoryWallet:t,walletUI:{appMode:a}}=(0,Z.Gf)();const{t:l}=(0,o.useTranslation)();const c=(0,T.pn)();const{setAvatar:i}=(0,_.yK)();const d=(0,_.ml)(k.pZ.nfts);const u=(0,_.ml)(k.pZ.send);const{id:v}=(0,e$.g)();const m=(0,_.s9)();const f=(0,P.am)();const S=el.Wallet.Cardano.AssetId(v);const w=null==m?void 0:m.get(S);const h=(0,s.useObservable)(t.balance.utxo.total$,ea.ly.utxo.total$);const g=(null==h?void 0:null===(e=h.assets)||void 0===e?void 0:e.get(S))||BigInt(1);const A=(0,n.useMemo)(()=>el.Wallet.util.calculateAssetBalance(g,w),[w,g]);const handleOpenSend=()=>{c.sendEventToPostHog(b.hs.SendClick,{trigger_point:P.A0.NFTS});f(v,ea.lt);u({params:{id:v}})};const handleSetAsAvatar=e=>{i(e);s.toast.notify({text:l("core.nftDetail.avatarUpdated")});c.sendEventToPostHog(b.hs.NFTDetailSetAsAvatarClick)};return n.createElement(s.Drawer,{popupView:true,className:eH.A.drawer,visible:true,navigation:n.createElement(s.DrawerNavigation,{onArrowIconClick:()=>d()}),dataTestId:"nft-details-drawer",footer:n.createElement("div",{className:eH.A.footer},n.createElement(s.Button,{id:eq.H.nftDetailsBtnId,className:eH.A.sendBtn,onClick:handleOpenSend},l("core.nftDetail.sendNFT")))},w&&n.createElement(r.NftDetail,NftDetail_extends({},(0,eQ.bo)(w),{isPopup:a===ea.hl,amount:A,title:n.createElement("h2",{className:eH.A.secondaryTitle},(0,eQ.P9)(w)),onSetAsAvatar:handleSetAsAvatar})))});var e0=a(17270);var e1=a(46485);var e4=a(23464);var e2=a.n(e4);var e5=a(10279);var e6=a.n(e5);var e7=a(20611);var e3=a(27758);e2().extend(e6())},50872:(e,t,a)=>{a.d(t,{dW:()=>r.d});var n=a(11226);var r=a(77012)},25002:(e,t,a)=>{a.d(t,{h:()=>getChainName});var n=a(82513);const getChainName=e=>{switch(e.networkMagic){case n.Wallet.Cardano.ChainIds.Mainnet.networkMagic:return"Mainnet";case n.Wallet.Cardano.ChainIds.Preprod.networkMagic:return"Preprod";case n.Wallet.Cardano.ChainIds.Preview.networkMagic:return"Preview";case n.Wallet.Cardano.ChainIds.Sanchonet.networkMagic:return"Sanchonet"}throw new Error("Chain name is not in known ChainIds")}},20611:(e,t,a)=>{a.d(t,{hx:()=>onStorageChangeEvent,kU:()=>saveValueInLocalStorage,m5:()=>deleteFromLocalStorage,qk:()=>getValueFromLocalStorage,sw:()=>clearLocalStorage,uA:()=>bufferReviver});var n=a(3668);var r=a.n(n);var s=a(1048)["Buffer"];const getValueFromLocalStorage=(e,t,a)=>{const n=window.localStorage.getItem(e);return n?JSON.parse(n,a):t};const saveValueInLocalStorage=({key:e,value:t,replacer:a,eventName:n})=>{const r=JSON.stringify(t,a);if(n){const s=new CustomEvent(n,{detail:{key:e,value:t}});window.dispatchEvent(s)}window.localStorage.setItem(e,r)};const deleteFromLocalStorage=e=>window.localStorage.removeItem(e);const clearLocalStorage=e=>{const t=(null==e?void 0:e.except)||[];Object.keys(window.localStorage).forEach(e=>{if(!t.includes(e))window.localStorage.removeItem(e)})};const onStorageChangeEvent=(e,t,a="any")=>{const listener=n=>{let s=true;switch(a){case"create":s=r()(n.oldValue)&&!r()(n.newValue);break;case"delete":s=!r()(n.oldValue)&&r()(n.newValue);break;case"change":s=!r()(n.oldValue)&&!r()(n.newValue);break;case"any":default:s=true}const o="string"==typeof e?"all"===e:e.includes(n.key);if(o&&s){if("string"==typeof t&&"reload"===t)return window.location.reload();if("function"==typeof t)return t(n)}};window.addEventListener("storage",listener);return()=>window.removeEventListener("storage",listener)};const bufferReviver=(e,t)=>{if(null!==t&&"object"==typeof t&&"type"in t&&"Buffer"===t.type&&"data"in t&&Array.isArray(t.data))return s.from(t.data);return t}},30220:(e,t,a)=>{a.d(t,{w:()=>D});var n=a(14041);var r=a(5218);var s=a(68350);var o=a(82513);var l=a(11230);var c=a(47590);var i=a(3705);var d=a(49199);var u=a(19454);var v=a(26814);var m=a(79457);var f=a(81122);var S=a(77407);var w=a(72165);var h=a(6285);var g=a(90604);var A=a(31010);var E=a(95623);var p=a(7472);var C=a(91456);var T=a(64219);var b=a(4114);var _=a(34671);var k=a(76379);var Z=a(7071);var N=a(52403);var y=a(63916);var I=a(67686);const x={[d.Z_.FORM]:"browserView.transaction.send.footer.review",[d.Z_.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:"browserView.transaction.send.coSign.footer.continue",[d.Z_.SUMMARY]:"browserView.transaction.send.footer.confirm",[d.Z_.CONFIRMATION]:"browserView.transaction.send.footer.confirm",[d.Z_.SUCCESS_TX]:"browserView.transaction.send.footer.viewTransaction",[d.Z_.FAIL_TX]:"browserView.transaction.send.footer.fail",[d.Z_.UNAUTHORIZED_TX]:"browserView.transaction.send.footer.unauthorized",[d.Z_.ADDRESS_FORM]:"browserView.transaction.send.footer.save",[d.Z_.ADDRESS_CHANGE]:"addressBook.reviewModal.confirmUpdate.button"};const hasTempTxData=()=>{const{tempOutputs:e,tempAddress:t}=(0,E.J1)();return null!==e||null!==t};const D=(0,T.fd)(({isPopupView:e,openContinueDialog:t,onHandleChangeConfirm:a})=>{const D=(0,n.useRef)();const triggerSubmit=()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.click()};const{t:M}=(0,r.useTranslation)();const{triggerPoint:V}=(0,u.Uh)();const{hasInvalidOutputs:F}=(0,u.kY)();const{builtTxData:R,setBuiltTxData:P}=(0,u.j9)();const{setSection:O,currentSection:H}=(0,u.WG)();const{setSubmitingTxState:L,isSubmitingTx:W,isPasswordValid:B}=(0,u.VY)();const{inMemoryWallet:U,isInMemoryWallet:X,walletType:G,isSharedWallet:z,currentChain:Y}=(0,m.Gf)();const{password:j,clearSecrets:K}=(0,y.useSecrets)();const[J]=(0,u.p_)();const{onClose:$,onCloseSubmitedTransaction:Q}=(0,v.QK)();const q=(0,_.pn)();const ee=(0,w.AE)();const[et,ea]=(0,n.useState)();const[en,er]=(0,n.useState)();const{addressToEdit:es}=(0,C.Y)();const{list:eo,utils:el}=(0,T.ye)();const{updateRecord:ec,deleteRecord:ei}=el;const ed=(0,w.cz)();const{isMaxAdaLoading:eu}=(0,u.Mn)();const{sharedWalletKey:ev,getSignPolicy:em}=(0,w.OO)();const[ef,{updateLocalStorage:eS}]=(0,w.Mj)("sharedWalletTransactions",{});const ew=H.currentSection===d.Z_.SUMMARY;const sendEventToPostHog=e=>q.sendEventToPostHog(e,{trigger_point:V,[h.m6]:h.gR.Internal});const eh=(0,n.useCallback)(()=>{switch(H.currentSection){case d.Z_.FORM:sendEventToPostHog(h.hs.SendTransactionDataReviewTransactionClick);break;case d.Z_.SUMMARY:sendEventToPostHog(h.hs.SendTransactionSummaryConfirmClick);break;case d.Z_.CONFIRMATION:sendEventToPostHog(h.hs.SendTransactionConfirmationConfirmClick);break;case d.Z_.SUCCESS_TX:sendEventToPostHog(h.hs.SendAllDoneViewTransactionClick);break;case d.Z_.UNAUTHORIZED_TX:case d.Z_.FAIL_TX:sendEventToPostHog(h.hs.SendSomethingWentWrongBackClick);break}},[H.currentSection,e]);const eg=(0,n.useCallback)(e=>{const t=eo.find(e=>e.address===es.address);ea(t.id);er(e);eh()},[eo,es.address,eh]);const onHandleCancel=()=>{ea(null)};const onHandleConfirm=async()=>{ea(null);if("DELETE"===en)ei(et,{text:M("browserView.addressBook.toast.deleteAddress"),icon:i.A});else{const e=await (0,b.JG)({address:es,handleResolver:ed});await ec(et,e,{text:M("browserView.addressBook.toast.editAddress"),icon:c.A})}a(en)};const eA=ew&&!X&&!z;const eE=(0,n.useCallback)(async()=>{if(z){let e;try{if(R.importedSharedWalletTx){const{auxiliaryData:t,body:a,id:n,witness:r}=R.importedSharedWalletTx.toCore();const s=await U.finalizeTx({tx:{body:a,hash:n},auxiliaryData:t,bodyCbor:R.importedSharedWalletTx.body().toCbor()});R.importedSharedWalletTx.setWitnessSet(N.SL.fromCore((0,I.G)(s.witness,r)));e=R.importedSharedWalletTx}else{const{auxiliaryData:o,body:l,hash:c}=await R.tx.inspect();const i=await U.finalizeTx({tx:{body:l,hash:c},auxiliaryData:o});e=N.ZX.fromCore(i)}}catch(d){throw d}const u=await em("payment");const v=u.requiredCosigners===e.toCore().witness.signatures.size;if(v)try{await U.submitTx(e.toCbor())}catch(m){throw m}else await (0,y.exportMultisigTransaction)({cborHex:e.toCbor(),publicKey:ev,chainId:Y});const f={[e.toCore().id.toString()]:(0,y.constructMultiSigTransactionData)({cborHex:e.toCbor(),publicKey:ev,chainId:Y})};eS({...ef,...f});P({...R,collectedEnoughSharedWalletTxSignatures:v})}else{const S=await R.tx.sign();try{await U.submitTx(S)}catch(w){throw w}k.Eo.next({id:S.tx.id.toString(),date:new Date().toString(),creationType:h.gR.Internal})}},[R,Y,em,U,z,P,ev,ef,eS]);const ep=(0,n.useCallback)(async()=>{if(W)return;L({isPasswordValid:true,isSubmitingTx:true});try{await (0,Z.Df)(eE,j.value);O({currentSection:d.Z_.SUCCESS_TX});L({isPasswordValid:true,isSubmitingTx:false})}catch(e){if(e instanceof o.Wallet.KeyManagement.errors.AuthenticationError)if(eA){O({currentSection:d.Z_.UNAUTHORIZED_TX});L({isSubmitingTx:false})}else L({isPasswordValid:false,isSubmitingTx:false});else{O({currentSection:d.Z_.FAIL_TX});L({isSubmitingTx:false})}}finally{K()}},[W,K,O,L,eE,j,eA]);(0,n.useEffect)(()=>{const onHardwareWalletDisconnect=e=>{if(e.device.opened){O({currentSection:d.Z_.FAIL_TX});L({isSubmitingTx:false})}};navigator.hid.addEventListener("disconnect",onHardwareWalletDisconnect);return()=>{navigator.hid.removeEventListener("disconnect",onHardwareWalletDisconnect)}},[O,L,e]);const eC=(0,n.useCallback)(()=>{eh();const a=H.currentSection===d.Z_.CONFIRMATION;const n=H.currentSection===d.Z_.SUCCESS_TX;const r=H.currentSection===d.Z_.FAIL_TX||H.currentSection===d.Z_.UNAUTHORIZED_TX;const s=H.currentSection===d.Z_.ADDRESS_CHANGE;if(hasTempTxData())(0,E.G3)();switch(true){case s:return eg("UPDATE");case ew&&!X&&!z:if(e)return t();return ep();case a:return ep();case n:return Q();case r:L({isPasswordValid:true});return O(S.ll[d.Z_.FORM]);default:return O()}},[H.currentSection,eg,ep,X,e,z,ew,Q,t,eh,O,L]);const handleClose=()=>{if(H.currentSection===d.Z_.SUCCESS_TX)sendEventToPostHog(h.hs.SendAllDoneCloseClick);else if(H.currentSection===d.Z_.FAIL_TX)sendEventToPostHog(h.hs.SendSomethingWentWrongCancelClick);$()};const eT=(0,n.useMemo)(()=>{return!R.importedSharedWalletTx&&(!R.tx||F)||(null==J?void 0:J.length)>S.go},[R.importedSharedWalletTx,R.tx,F,null==J?void 0:J.length]);const eb=(0,n.useMemo)(()=>H.currentSection===d.Z_.CONFIRMATION&&(W||!B||!j.value||!ee),[H.currentSection,W,B,j.value,ee]);const e_=(0,n.useMemo)(()=>{if(eA){const t=e?M("browserView.transaction.send.footer.continueInAdvancedView"):M("browserView.transaction.send.footer.confirmWithDevice",{hardwareWallet:G});return W?M("browserView.transaction.send.footer.signing"):t}if(z&&H.currentSection===d.Z_.SUCCESS_TX)return M("general.button.view-co-signers");return M(x[H.currentSection])},[eA,z,H.currentSection,M,e,G,W]);const ek=(0,n.useMemo)(()=>{if(H.currentSection===d.Z_.SUCCESS_TX)return M("browserView.transaction.send.footer.close");if(H.currentSection===d.Z_.ADDRESS_CHANGE)return M("addressBook.reviewModal.cancelUpdate.button");return M("browserView.transaction.send.footer.cancel")},[M,H.currentSection]);const eZ=(eT||eb||eu)&&H.currentSection!==d.Z_.ADDRESS_CHANGE;const eN=(0,n.useCallback)(()=>{triggerSubmit()},[]);(0,n.useEffect)(()=>{const cleanup=()=>{if(hasTempTxData())(0,E.G3)()};if(e)return cleanup;if(W)return cleanup;if(eZ)return cleanup;const{tempSource:t}=(0,E.J1)();if(hasTempTxData()&&"hardware-wallet"===t)eN()},[eZ,eA,e,W,eN]);if([d.Z_.ADDRESS_LIST,d.Z_.ADDRESS_FORM].includes(H.currentSection))return null;if(H.currentSection===d.Z_.ASSET_PICKER)return n.createElement(A.M,null);if(H.currentSection===d.Z_.ADDRESS_FORM)return n.createElement(f.o,null);return n.createElement(n.Fragment,null,n.createElement("div",{className:l.A.footer},n.createElement(s.Button,{size:"large",block:true,disabled:eZ,loading:W,onClick:eC,ref:D,id:g.H.sendNextBtnId,"data-testid":"send-next-btn"},e_),n.createElement(s.Button,{color:"secondary",size:"large",block:true,onClick:H.currentSection===d.Z_.ADDRESS_CHANGE?()=>eg("DELETE"):handleClose,"data-testid":"send-cancel-btn"},ek)),n.createElement(p.n,{action:en,onCancel:onHandleCancel,onConfirm:onHandleConfirm,visible:!!et,isPopup:e}))})},79324:(e,t,a)=>{a.d(t,{Z:()=>n.Z,y:()=>n.y});var n=a(49816)}}]);