"use strict";(self["webpackChunk_lace_browser_extension_wallet"]=self["webpackChunk_lace_browser_extension_wallet"]||[]).push([[327],{68573:(e,t,a)=>{a.d(t,{A:()=>n});const n=a.p+"6f67e09126f1f0f636629f6d8be36aea.svg"},4052:(e,t,a)=>{a.d(t,{C:()=>AssetsCounter});var n=a(14041);var r=a(4531);const AssetsCounter=({count:e})=>n.createElement("div",{className:r.A.container,"data-testid":"assets-counter"},n.createElement("p",null,e))},44470:(e,t,a)=>{a.d(t,{I:()=>SelectTokenButton});var n=a(14041);var r=a(68350);var s=a(4052);var o=a(86004);const SelectTokenButton=({label:e,onClick:t,count:a=0,btnStyle:l,testId:c})=>n.createElement("div",{className:o.A.container},a>0&&n.createElement(s.C,{count:a}),n.createElement(r.Button,{"data-testid":c,style:l,onClick:t,color:"secondary",variant:"outlined",className:o.A.selectMultipleBtn},e))},51314:(e,t,a)=>{a.d(t,{v:()=>n.v});var n=a(92185)},91456:(e,t,a)=>{a.d(t,{Y:()=>n.Y});var n=a(7857)},30037:(e,t,a)=>{a.d(t,{ef:()=>l.ef});var n=a(14041);var r=a(45636);var s=a(5218);var o=a(82443);var l=a(99004)},62055:(e,t,a)=>{a.d(t,{m:()=>UnlockWallet});var n=a(14041);var r=a(45636);var s=a(68573);var o=a(68350);var l=a(63916);var c=a(22857);var i=a(5218);var d=a(18576);const UnlockWallet=({onUnlock:e,onForgotPasswordClick:t,passwordInput:a,unlockButtonDisabled:v,showForgotPassword:u=true})=>{const{t:m}=(0,i.useTranslation)();return n.createElement(r.s7,null,n.createElement("form",{onSubmit:e,className:c.A.lockWalletContent},n.createElement("div",{className:c.A.content,"data-testid":"unlock-screen"},n.createElement("img",{src:s.A,alt:"LACE",className:c.A.image,"data-testid":"unlock-screen-img"}),n.createElement("h1",{className:c.A.title,"data-testid":"unlock-screen-title"},m("unlock.sectionTitle")),n.createElement(l.Password,{errorMessage:m("general.errors.invalidPassword"),error:a.invalidPass,onChange:a.handleChange,onPressEnter:t=>{t.preventDefault();e()},label:m("unlock.input.placeholder")})),n.createElement("div",{className:c.A.blockButton},n.createElement(o.Button,{color:"gradient",onClick:e,disabled:v,"data-testid":"unlock-button"},m("unlock.button"))),u&&n.createElement(d.X,{onForgotPasswordClick:t})))}},17270:(e,t,a)=>{a.d(t,{Ss:()=>n.Ss,h8:()=>n.h8});var n=a(85979)},79391:(e,t,a)=>{a.d(t,{N:()=>UIThemeProvider});var n=a(14041);var r=a(80003);var s=a.n(r);var o=a(29284);const UIThemeProvider=({children:e})=>{const{theme:t}=(0,o.D)();return n.createElement(r.ThemeProvider,{colorScheme:"light"===t.name?r.ThemeColorScheme.Light:r.ThemeColorScheme.Dark},e)}},82340:(e,t,a)=>{var n=a(14041);var r=a(63916);var s=a(68350);var o=a(5218);var l=a(72591);var c=a.n(l);var i=a(1740);var d=a.n(i);var v=a(88128);var u=a.n(v);var m=a(30855);var f=a.n(m);var S=a(93051);var w=a.n(S);var A=a(73656);var E=a.n(A);var g=a(88901);var h={};h.styleTagTransform=E();h.setAttributes=f();h.insert=u().bind(null,"head");h.domAPI=d();h.insertStyleElement=w();var p=c()(g.A,h);g.A&&g.A.locals&&g.A.locals;var T=a(29284);var C=a(34671);var b=a(6285);var _=a(72165);var k=a(19065);var Z=a(79457);var N=a(69777);var y=a(45636);var I=a(93750);var x=a(45874);var D={};D.styleTagTransform=E();D.setAttributes=f();D.insert=u().bind(null,"head");D.domAPI=d();D.insertStyleElement=w();var V=c()(x.A,D);x.A&&x.A.locals&&x.A.locals;var F=a(76647);var M=a(85498);var R=a(14024);var O=a(41926);var P=a(93055);var H=a(40228);var L=a(56830);var B=a(64815);var U=a(42509);var W=a(45026);var X={};X.styleTagTransform=E();X.setAttributes=f();X.insert=u().bind(null,"head");X.domAPI=d();X.insertStyleElement=w();var G=c()(W.A,X);W.A&&W.A.locals&&W.A.locals;var z=a(95623);var Y=a(97177);var j=a(7502);var K=a(37769);var J=a(76306);var $=a(65711);var Q=a(52033);var q=a(39260);var ee={};ee.styleTagTransform=E();ee.setAttributes=f();ee.insert=u().bind(null,"head");ee.domAPI=d();ee.insertStyleElement=w();var et=c()(q.A,ee);q.A&&q.A.locals&&q.A.locals;var ea=a(15937);var en=a(7071);var er=a(74355);var es=a(31562);var eo=a(60986);var el=a(82513);var ec=a(11226);var ei=a(27085);var ed=a(70106);var ev=a(75004);var eu=a(79324);var em=a(13303);var ef=a(53046);var eS=a(41871);var ew=a(74103);var eA,eE;function expand_gradient_component_extends(){expand_gradient_component_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n))e[n]=a[n]}return e};return expand_gradient_component_extends.apply(this,arguments)}var SvgExpandGradientcomponent=function(e){return React.createElement("svg",expand_gradient_component_extends({width:"1em",height:"1em",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),eA||(eA=React.createElement("path",{d:"M3.5 8a1 1 0 0 0 2 0h-2Zm1-4V3a1 1 0 0 0-1 1h1Zm4 1a1 1 0 0 0 0-2v2Zm11 3a1 1 0 1 0 2 0h-2Zm1-4h1a1 1 0 0 0-1-1v1Zm-4-1a1 1 0 1 0 0 2V3Zm-11 13a1 1 0 1 0-2 0h2Zm-1 4h-1a1 1 0 0 0 1 1v-1Zm4 1a1 1 0 1 0 0-2v2Zm1.707-5.293a1 1 0 0 0-1.414-1.414l1.414 1.414Zm4.586-7.414a1 1 0 0 0 1.414 1.414l-1.414-1.414Zm-6 1.414a1 1 0 0 0 1.414-1.414L8.793 9.707ZM20.5 20v1a1 1 0 0 0 1-1h-1Zm-4.293-5.707a1 1 0 0 0-1.414 1.414l1.414-1.414ZM21.5 16a1 1 0 1 0-2 0h2Zm-5 3a1 1 0 1 0 0 2v-2ZM5.5 8V4h-2v4h2Zm-1-3h4V3h-4v2Zm17 3V4h-2v4h2Zm-1-5h-4v2h4V3Zm-17 13v4h2v-4h-2Zm1 5h4v-2h-4v2Zm.707-.293 5-5-1.414-1.414-5 5 1.414 1.414Zm11-11 5-5-1.414-1.414-5 5 1.414 1.414Zm-6-1.414-5-5-1.414 1.414 5 5 1.414-1.414Zm11 11-5-5-1.414 1.414 5 5 1.414-1.414ZM19.5 16v4h2v-4h-2Zm1 3h-4v2h4v-2Z",fill:"url(#expand-gradient_component_svg__a)"})),eE||(eE=React.createElement("defs",null,React.createElement("linearGradient",{id:"expand-gradient_component_svg__a",x1:1.572,y1:1.072,x2:25.014,y2:2.801,gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#FF92E1"}),React.createElement("stop",{offset:1,stopColor:"#FDC300"})))))};var eg=a(8125);var eh={};eh.styleTagTransform=E();eh.setAttributes=f();eh.insert=u().bind(null,"head");eh.domAPI=d();eh.insertStyleElement=w();var ep=c()(eg.A,eh);eg.A&&eg.A.locals&&eg.A.locals;const{Text:eT}=ef.A;var eC=a(51314);new Set([eu.Z.CONFIRMATION,eu.Z.SIGN,eu.Z.FAIL_TX,eu.Z.SUCCESS_TX]);new Set([eu.Z.CONFIRMATION,eu.Z.SIGN]);new Set([eu.Z.DETAIL,eu.Z.CONFIRMATION,eu.Z.SIGN]);var eb=a(27739);var e_=a(64219);var ek=a(74342);var eZ=a(91456);var eN=a(53306);var ey=a(3705);var eI=a(9499);var ex=a(9189);var eD=a(91616);const eV="popupAddressBookContainerId";(0,e_.fd)(()=>{var e,t,a,l;const[c,i]=(0,n.useState)(false);const{list:d,count:v,utils:u}=(0,e_.ye)();const{extendLimit:m,deleteRecord:f}=u;const{setIsEditAddressVisible:S,isEditAddressVisible:w,setAddressToEdit:A,addressToEdit:E}=(0,eZ.Y)();const{t:g}=(0,o.useTranslation)();const h=(0,C.pn)();const p=(0,_.cz)();const T=(0,_.BM)(d,p);const{onSaveAddressActions:k}=(0,_.iF)();const{setSection:Z}=(0,O.WG)();const N={name:g("core.walletAddressList.name"),address:g("core.walletAddressList.address")};const onAddressSave=e=>k(e,E);var I;const x=(0,n.useMemo)(()=>{return(null==d?void 0:d.map(e=>{var t;return{id:e.id,address:e.address,name:e.name,onClick:e=>{var t;h.sendEventToPostHog(b.hs.AddressBookAddressRecordClick);A(e);if(eD.I&&(null===(t=T[e.address])||void 0===t?void 0:t.isValid)===false)i(true);else S(true)},isSmall:true,isAddressWarningVisible:null!==(I=eD.I&&(null===(t=T[e.address])||void 0===t?void 0:t.isValid)===false)&&void 0!==I&&I}}))||[]},[d,h,A,S,T]);const D=(0,n.useCallback)(()=>{m()},[m]);const handleAddAddressClick=()=>{S(true);h.sendEventToPostHog(b.hs.AddressBookAddAddressClick)};const V=(null==E?void 0:E.id)?ex.Q.DETAILS:ex.Q.CREATE;const onHandleDeleteContact=e=>{f(e,{text:g("browserView.addressBook.toast.deleteAddress"),icon:ey.A});A({})};var F,M;return n.createElement(n.Fragment,null,n.createElement(y.s7,{title:n.createElement("div",{className:eN.A.title},n.createElement("h1",{"data-testid":"page-title"},g("addressBook.sectionTitle")," ",n.createElement("span",{className:eN.A.subTitle,"data-testid":"counter"},"(",v,")"))),id:eV},n.createElement("div",{className:eN.A.btnContainer},n.createElement(s.Button,{"data-testid":"add-address-button",color:"gradient",block:true,onClick:handleAddAddressClick},n.createElement("img",{src:eI.A,alt:"plus-icon"}),g("addressBook.empty.addNewAddress"))),0===v?n.createElement("div",{className:eN.A.emptyScreen,"data-testid":"empty-address-book"},n.createElement(eb.t,null)):n.createElement("div",{className:eN.A.listContainer,"data-testid":"address-book-list"},n.createElement(r.WalletAddressList,{scrollableTargetId:eV,className:eN.A.addressList,items:x,loadMoreData:D,locale:{emptyText:true},total:v,withHeader:false,popupView:true,translations:N}))),eD.I&&n.createElement(ek.t,{visible:c,onCancelClick:()=>{A({});i(false);Z({currentSection:O.Z_.FORM})},expectedAddress:null!==(F=null===(e=T[E.address])||void 0===e?void 0:null===(t=e.error)||void 0===t?void 0:t.expectedAddress)&&void 0!==F?F:"",actualAddress:null!==(M=null===(a=T[E.address])||void 0===a?void 0:null===(l=a.error)||void 0===l?void 0:l.actualAddress)&&void 0!==M?M:"",initialValues:E,popupView:true}),n.createElement(ek.Z,{initialStep:V,initialValues:E,onCancelClick:()=>{A({});S(false)},onConfirmClick:async e=>{await onAddressSave(e);A({})},onDelete:e=>onHandleDeleteContact(e),visible:w,popupView:true}))});var eF=a(30037);var eM=a(75857);var eR=a.n(eM);var eO=a(3668);var eP=a.n(eO);var eH=a(85164);var eL=a(97629);var eB=a(5735);var eU=a(53962);var eW=a(26599);var eX=a(20684);var eG=a(87660);var ez=a(22953);var eY=a(80003);var ej=a(49101);var eK=a(41512);const eJ=10;(0,eW.Ko)(()=>{const e=(0,_.ml)(k.pZ.nftDetail);const[t,a]=(0,n.useState)(false);const{environmentName:l}=(0,Z.Gf)();const[c,i]=(0,n.useState)();const{walletInfo:d,inMemoryWallet:v}=(0,Z.Gf)();const{t:u}=(0,o.useTranslation)();const m=(0,_.s9)();const{isSearching:f,handleSearch:S,filteredResults:w}=(0,eK.E)(m);const A=(0,s.useObservable)(v.balance.utxo.total$,ea.ly.utxo.total$);const E=(0,C.pn)();const{fiatCurrency:g}=(0,C.cn)();const[h,p]=(0,n.useState)();const[T,N]=(0,n.useState)();const[I,x]=(0,n.useState)(false);const[D,V]=(0,n.useState)(false);const{utils:{deleteRecord:M}}=(0,eW.zH)();const[R,O]=(0,n.useState)("");const[P,H]=(0,n.useState)(false);const L=(0,n.useCallback)(t=>{E.sendEventToPostHog(b.hs.NFTsImageClick);e({params:{id:t.assetId.toString()}})},[E,e]);const B=(0,n.useMemo)(()=>{const{nftList:e}=(0,eL.iM)({assetsInfo:m,balance:null==A?void 0:A.assets,environmentName:l,fiatCurrency:g});return e.map(e=>({...e,type:r.NftsItemsTypes.NFT,onClick:()=>L(e)}))},[null==A?void 0:A.assets,m,l,g,L]);const U=(0,n.useCallback)((e,t)=>[{label:u("browserView.nfts.contextMenu.rename"),onClick:()=>{x(true);p({id:e,name:t})}},{label:u("browserView.nfts.contextMenu.delete"),onClick:()=>{N(e);V(true)}}],[u]);const{list:W}=(0,eW.zH)();const X=(0,n.useMemo)(()=>{return(null==W?void 0:W.map(({name:e,assets:t,id:n})=>({id:n,name:e,type:r.NftsItemsTypes.FOLDER,nfts:t.map(e=>B.find(({assetId:t})=>t.toString()===e)).filter(e=>!!e),contextMenuItems:U(n,e),onClick:()=>{i(n);a(true)}})))||[]},[W,B,U]);const G=(0,n.useMemo)(()=>X.find(({id:e})=>c===e),[c,X]);const z=eR()(null==W?void 0:W.map(({assets:e})=>e));const Y=B.filter(({assetId:e})=>!z.includes(e));const j=[...X,...Y];const K=eP()(A)||eP()(W);const onDeleteFolderConfirm=()=>{V(false);M(T,{text:u("browserView.nfts.deleteFolderSuccess"),icon:ez.A})};const J=(0,n.useCallback)(()=>{a(false);i(void 0)},[]);const handleNftSearch=(e,t)=>{O(t);if(!P){E.sendEventToPostHog(b.hs.NFTsSearchType);H(true)}S(e,t)};return n.createElement(n.Fragment,null,n.createElement(y.s7,{title:n.createElement("div",{className:eH.A.sectionTitle},n.createElement(Q._,{classname:eH.A.title,title:u("browserView.nfts.pageTitle"),sideText:`(${B.length})`,isPopup:true}),B.length>0&&true&&n.createElement(s.Button,{className:eH.A.newFolderBtn,color:"gradient",onClick:()=>{a(true);E.sendEventToPostHog(b.hs.NFTsCreateFolderClick)},"data-testid":"create-folder-button"},n.createElement(eB.A,{className:eH.A.newFolderIcon}))),isLoading:K,mainClassName:eH.A.nftsLayout},n.createElement("div",{className:eH.A.nfts},n.createElement("div",{className:eH.A.content,"data-testid":"nft-list-container"},j.length>0?n.createElement(n.Fragment,null,j.length>=eJ&&n.createElement(eY.SearchBox,{placeholder:u("browserView.nfts.searchPlaceholder"),onChange:e=>handleNftSearch(B,e),"data-testid":"nft-search-input",value:R,onClear:()=>O("")}),n.createElement(ej.A,{loading:f},""!==R&&w.length>0&&n.createElement(r.NftList,{items:w,rows:2}),""!==R&&0===w.length&&n.createElement(r.ListEmptyState,{message:u("core.assetSelectorOverlay.noMatchingResult"),icon:"sad-face"}),""===R&&n.createElement(r.NftList,{items:j,rows:2}))):n.createElement(F.h_,{title:u("browserView.nfts.fundWalletBanner.title"),prompt:u("browserView.nfts.fundWalletBanner.prompt"),walletAddress:d.addresses[0].address.toString()}))),n.createElement(eU.i,{selectedFolder:G,onSelectNft:L,visible:t,onClose:J,isPopupView:true}),n.createElement(eX.A,{folderToRename:h,visible:I,onClose:()=>x(false),isPopupView:true})),n.createElement(eG.d,{onCancel:()=>V(false),visible:D,title:u("browserView.nfts.deleteFolderModal.header"),description:n.createElement(n.Fragment,null,n.createElement("div",null,u("browserView.nfts.deleteFolderModal.description1")),n.createElement("div",{className:"mt-3"},u("browserView.nfts.deleteFolderModal.description2"))),actions:[{body:u("browserView.nfts.deleteFolderModal.cancel"),dataTestId:"delete-folder-modal-cancel",color:"secondary",onClick:()=>V(false)},{dataTestId:"delete-folder-modal-confirm",onClick:onDeleteFolderConfirm,body:u("browserView.nfts.deleteFolderModal.confirm")}]}))});var e$=a(86090);var eQ=a(95514);var eq=a(90604);function NftDetail_extends(){NftDetail_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)if(Object.prototype.hasOwnProperty.call(a,n))e[n]=a[n]}return e};return NftDetail_extends.apply(this,arguments)}(0,eW.Ko)(()=>{var e;const{inMemoryWallet:t,walletUI:{appMode:a}}=(0,Z.Gf)();const{t:l}=(0,o.useTranslation)();const c=(0,C.pn)();const{setAvatar:i}=(0,_.yK)();const d=(0,_.ml)(k.pZ.nfts);const v=(0,_.ml)(k.pZ.send);const{id:u}=(0,e$.g)();const m=(0,_.s9)();const f=(0,O.am)();const S=el.Wallet.Cardano.AssetId(u);const w=null==m?void 0:m.get(S);const A=(0,s.useObservable)(t.balance.utxo.total$,ea.ly.utxo.total$);const E=(null==A?void 0:null===(e=A.assets)||void 0===e?void 0:e.get(S))||BigInt(1);const g=(0,n.useMemo)(()=>el.Wallet.util.calculateAssetBalance(E,w),[w,E]);const handleOpenSend=()=>{c.sendEventToPostHog(b.hs.SendClick,{trigger_point:O.A0.NFTS});f(u,ea.lt);v({params:{id:u}})};const handleSetAsAvatar=e=>{i(e);s.toast.notify({text:l("core.nftDetail.avatarUpdated")});c.sendEventToPostHog(b.hs.NFTDetailSetAsAvatarClick)};return n.createElement(s.Drawer,{popupView:true,className:eH.A.drawer,visible:true,navigation:n.createElement(s.DrawerNavigation,{onArrowIconClick:()=>d()}),dataTestId:"nft-details-drawer",footer:n.createElement("div",{className:eH.A.footer},n.createElement(s.Button,{id:eq.H.nftDetailsBtnId,className:eH.A.sendBtn,onClick:handleOpenSend},l("core.nftDetail.sendNFT")))},w&&n.createElement(r.NftDetail,NftDetail_extends({},(0,eQ.bo)(w),{isPopup:a===ea.hl,amount:g,title:n.createElement("h2",{className:eH.A.secondaryTitle},(0,eQ.P9)(w)),onSetAsAvatar:handleSetAsAvatar})))});var e0=a(17270);var e1=a(46485);var e4=a(23464);var e2=a.n(e4);var e5=a(10279);var e7=a.n(e5);var e6=a(20611);var e3=a(27758);e2().extend(e7())},50872:(e,t,a)=>{a.d(t,{dW:()=>r.d});var n=a(11226);var r=a(77012)},20611:(e,t,a)=>{a.d(t,{hx:()=>onStorageChangeEvent,kU:()=>saveValueInLocalStorage,m5:()=>deleteFromLocalStorage,qk:()=>getValueFromLocalStorage,sw:()=>clearLocalStorage,uA:()=>bufferReviver});var n=a(3668);var r=a.n(n);var s=a(1048)["Buffer"];const getValueFromLocalStorage=(e,t,a)=>{const n=window.localStorage.getItem(e);return n?JSON.parse(n,a):t};const saveValueInLocalStorage=({key:e,value:t,replacer:a,eventName:n})=>{const r=JSON.stringify(t,a);if(n){const s=new CustomEvent(n,{detail:{key:e,value:t}});window.dispatchEvent(s)}window.localStorage.setItem(e,r)};const deleteFromLocalStorage=e=>window.localStorage.removeItem(e);const clearLocalStorage=e=>{const t=(null==e?void 0:e.except)||[];Object.keys(window.localStorage).forEach(e=>{if(!t.includes(e))window.localStorage.removeItem(e)})};const onStorageChangeEvent=(e,t,a="any")=>{const listener=n=>{let s=true;switch(a){case"create":s=r()(n.oldValue)&&!r()(n.newValue);break;case"delete":s=!r()(n.oldValue)&&r()(n.newValue);break;case"change":s=!r()(n.oldValue)&&!r()(n.newValue);break;case"any":default:s=true}const o="string"==typeof e?"all"===e:e.includes(n.key);if(o&&s){if("string"==typeof t&&"reload"===t)return window.location.reload();if("function"==typeof t)return t(n)}};window.addEventListener("storage",listener);return()=>window.removeEventListener("storage",listener)};const bufferReviver=(e,t)=>{if(null!==t&&"object"==typeof t&&"type"in t&&"Buffer"===t.type&&"data"in t&&Array.isArray(t.data))return s.from(t.data);return t}},30220:(e,t,a)=>{a.d(t,{w:()=>x});var n=a(14041);var r=a(5218);var s=a(68350);var o=a(82513);var l=a(11230);var c=a(47590);var i=a(3705);var d=a(49199);var v=a(19454);var u=a(26814);var m=a(79457);var f=a(81122);var S=a(77407);var w=a(72165);var A=a(6285);var E=a(90604);var g=a(31010);var h=a(95623);var p=a(7472);var T=a(91456);var C=a(64219);var b=a(4114);var _=a(34671);var k=a(76379);var Z=a(7071);var N=a(23924);var y=a(63916);const I={[d.Z_.FORM]:"browserView.transaction.send.footer.review",[d.Z_.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:"browserView.transaction.send.coSign.footer.continue",[d.Z_.SUMMARY]:"browserView.transaction.send.footer.confirm",[d.Z_.CONFIRMATION]:"browserView.transaction.send.footer.confirm",[d.Z_.SUCCESS_TX]:"browserView.transaction.send.footer.viewTransaction",[d.Z_.FAIL_TX]:"browserView.transaction.send.footer.fail",[d.Z_.UNAUTHORIZED_TX]:"browserView.transaction.send.footer.unauthorized",[d.Z_.ADDRESS_FORM]:"browserView.transaction.send.footer.save",[d.Z_.ADDRESS_CHANGE]:"addressBook.reviewModal.confirmUpdate.button"};const hasTempTxData=()=>{const{tempOutputs:e,tempAddress:t}=(0,h.J1)();return null!==e||null!==t};const x=(0,C.fd)(({isPopupView:e,openContinueDialog:t,onHandleChangeConfirm:a})=>{const x=(0,n.useRef)();const triggerSubmit=()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.click()};const{t:D}=(0,r.useTranslation)();const{triggerPoint:V}=(0,v.Uh)();const{hasInvalidOutputs:F}=(0,v.kY)();const{builtTxData:M,setBuiltTxData:R}=(0,v.j9)();const{setSection:O,currentSection:P}=(0,v.WG)();const{setSubmitingTxState:H,isSubmitingTx:L,isPasswordValid:B}=(0,v.VY)();const{inMemoryWallet:U,isInMemoryWallet:W,walletType:X,isSharedWallet:G,currentChain:z}=(0,m.Gf)();const{password:Y,clearSecrets:j}=(0,y.useSecrets)();const[K]=(0,v.p_)();const{onClose:J,onCloseSubmitedTransaction:$}=(0,u.QK)();const Q=(0,_.pn)();const q=(0,w.AE)();const[ee,et]=(0,n.useState)();const[ea,en]=(0,n.useState)();const{addressToEdit:er}=(0,T.Y)();const{list:es,utils:eo}=(0,C.ye)();const{updateRecord:el,deleteRecord:ec}=eo;const ei=(0,w.cz)();const{isMaxAdaLoading:ed}=(0,v.Mn)();const{sharedWalletKey:ev,getSignPolicy:eu}=(0,w.OO)();const em=P.currentSection===d.Z_.SUMMARY;const sendEventToPostHog=e=>Q.sendEventToPostHog(e,{trigger_point:V,[A.m6]:A.gR.Internal});const ef=(0,n.useCallback)(()=>{switch(P.currentSection){case d.Z_.FORM:sendEventToPostHog(A.hs.SendTransactionDataReviewTransactionClick);break;case d.Z_.SUMMARY:sendEventToPostHog(A.hs.SendTransactionSummaryConfirmClick);break;case d.Z_.CONFIRMATION:sendEventToPostHog(A.hs.SendTransactionConfirmationConfirmClick);break;case d.Z_.SUCCESS_TX:sendEventToPostHog(A.hs.SendAllDoneViewTransactionClick);break;case d.Z_.UNAUTHORIZED_TX:case d.Z_.FAIL_TX:sendEventToPostHog(A.hs.SendSomethingWentWrongBackClick);break}},[P.currentSection,e]);const eS=(0,n.useCallback)(e=>{const t=es.find(e=>e.address===er.address);et(t.id);en(e);ef()},[es,er.address,ef]);const onHandleCancel=()=>{et(null)};const onHandleConfirm=async()=>{et(null);if("DELETE"===ea)ec(ee,{text:D("browserView.addressBook.toast.deleteAddress"),icon:i.A});else{const e=await (0,b.JG)({address:er,handleResolver:ei});await el(ee,e,{text:D("browserView.addressBook.toast.editAddress"),icon:c.A})}a(ea)};const ew=em&&!W&&!G;const eA=(0,n.useCallback)(async()=>{if(G){let e;try{if(M.importedSharedWalletTx){e=N.ZX.fromCbor(await U.addSignatures({tx:M.importedSharedWalletTx.toCbor()}));M.importedSharedWalletTx.setWitnessSet(e.witnessSet())}else{const{auxiliaryData:t,body:a,hash:n}=await M.tx.inspect();const r=await U.finalizeTx({tx:{body:a,hash:n},auxiliaryData:t});e=N.ZX.fromCore(r)}}catch(s){throw s}const o=await eu("payment");const l=o.requiredCosigners===e.toCore().witness.signatures.size;if(l)try{await U.submitTx(e.toCbor())}catch(c){throw c}else await (0,y.exportMultisigTransaction)({cborHex:e.toCbor(),publicKey:ev,chainId:z});R({...M,collectedEnoughSharedWalletTxSignatures:l})}else{const i=await M.tx.sign();try{await U.submitTx(i)}catch(d){throw d}k.Eo.next({id:i.tx.id.toString(),date:new Date().toString(),creationType:A.gR.Internal})}},[M,z,eu,U,G,R,ev]);const eE=(0,n.useCallback)(async()=>{if(L)return;H({isPasswordValid:true,isSubmitingTx:true});try{await (0,Z.Df)(eA,Y.value);O({currentSection:d.Z_.SUCCESS_TX});H({isPasswordValid:true,isSubmitingTx:false})}catch(e){if(e instanceof o.Wallet.KeyManagement.errors.AuthenticationError)if(ew){O({currentSection:d.Z_.UNAUTHORIZED_TX});H({isSubmitingTx:false})}else H({isPasswordValid:false,isSubmitingTx:false});else{O({currentSection:d.Z_.FAIL_TX});H({isSubmitingTx:false})}}finally{j()}},[L,j,O,H,eA,Y,ew]);(0,n.useEffect)(()=>{const onHardwareWalletDisconnect=e=>{if(e.device.opened){O({currentSection:d.Z_.FAIL_TX});H({isSubmitingTx:false})}};navigator.hid.addEventListener("disconnect",onHardwareWalletDisconnect);return()=>{navigator.hid.removeEventListener("disconnect",onHardwareWalletDisconnect)}},[O,H,e]);const eg=(0,n.useCallback)(()=>{ef();const a=P.currentSection===d.Z_.CONFIRMATION;const n=P.currentSection===d.Z_.SUCCESS_TX;const r=P.currentSection===d.Z_.FAIL_TX||P.currentSection===d.Z_.UNAUTHORIZED_TX;const s=P.currentSection===d.Z_.ADDRESS_CHANGE;if(hasTempTxData())(0,h.G3)();switch(true){case s:return eS("UPDATE");case em&&!W&&!G:if(e)return t();return eE();case a:return eE();case n:return $();case r:H({isPasswordValid:true});return O(S.ll[d.Z_.FORM]);default:return O()}},[P.currentSection,eS,eE,W,e,G,em,$,t,ef,O,H]);const handleClose=()=>{if(P.currentSection===d.Z_.SUCCESS_TX)sendEventToPostHog(A.hs.SendAllDoneCloseClick);else if(P.currentSection===d.Z_.FAIL_TX)sendEventToPostHog(A.hs.SendSomethingWentWrongCancelClick);J()};const eh=(0,n.useMemo)(()=>{return!M.importedSharedWalletTx&&(!M.tx||F)||(null==K?void 0:K.length)>S.go},[M.importedSharedWalletTx,M.tx,F,null==K?void 0:K.length]);const ep=(0,n.useMemo)(()=>P.currentSection===d.Z_.CONFIRMATION&&(L||!B||!Y.value||!q),[P.currentSection,L,B,Y.value,q]);const eT=(0,n.useMemo)(()=>{if(ew){const t=e?D("browserView.transaction.send.footer.continueInAdvancedView"):D("browserView.transaction.send.footer.confirmWithDevice",{hardwareWallet:X});return L?D("browserView.transaction.send.footer.signing"):t}if(G&&P.currentSection===d.Z_.SUCCESS_TX)return D("general.button.view-co-signers");return D(I[P.currentSection])},[ew,G,P.currentSection,D,e,X,L]);const eC=(0,n.useMemo)(()=>{if(P.currentSection===d.Z_.SUCCESS_TX)return D("browserView.transaction.send.footer.close");if(P.currentSection===d.Z_.ADDRESS_CHANGE)return D("addressBook.reviewModal.cancelUpdate.button");return D("browserView.transaction.send.footer.cancel")},[D,P.currentSection]);const eb=(eh||ep||ed)&&P.currentSection!==d.Z_.ADDRESS_CHANGE;const e_=(0,n.useCallback)(()=>{triggerSubmit()},[]);(0,n.useEffect)(()=>{const cleanup=()=>{if(hasTempTxData())(0,h.G3)()};if(e)return cleanup;if(L)return cleanup;if(eb)return cleanup;const{tempSource:t}=(0,h.J1)();if(hasTempTxData()&&"hardware-wallet"===t)e_()},[eb,ew,e,L,e_]);if([d.Z_.ADDRESS_LIST,d.Z_.ADDRESS_FORM].includes(P.currentSection))return null;if(P.currentSection===d.Z_.ASSET_PICKER)return n.createElement(g.M,null);if(P.currentSection===d.Z_.ADDRESS_FORM)return n.createElement(f.o,null);return n.createElement(n.Fragment,null,n.createElement("div",{className:l.A.footer},n.createElement(s.Button,{size:"large",block:true,disabled:eb,loading:L,onClick:eg,ref:x,id:E.H.sendNextBtnId,"data-testid":"send-next-btn"},eT),n.createElement(s.Button,{color:"secondary",size:"large",block:true,onClick:P.currentSection===d.Z_.ADDRESS_CHANGE?()=>eS("DELETE"):handleClose,"data-testid":"send-cancel-btn"},eC)),n.createElement(p.n,{action:ea,onCancel:onHandleCancel,onConfirm:onHandleConfirm,visible:!!ee,isPopup:e}))})},79324:(e,t,a)=>{a.d(t,{Z:()=>n.Z,y:()=>n.y});var n=a(49816)}}]);