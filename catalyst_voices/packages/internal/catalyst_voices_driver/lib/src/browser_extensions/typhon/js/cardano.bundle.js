const DAPP_METHOD_ERROR_REASON={ABORT:"ABORT",REJECT:"REJECT",ERROR:"ERROR",INVALID_REQUEST:"INVALID_REQUEST"},DAPP_METHOD_ERROR_CODE={INVALID_REQUEST:-1,ERROR:-2,ABORT:-3,REJECT:-3,ACCOUNT_CHANGE:-4},SENDER={ContentScript:"typhon_contentScript",WebPage:"typhon_webpage"},WINDOW_COMMUNICATION_METHODS={ENABLE:"ENABLE",IS_ENABLED:"IS_ENABLED",GET_NETWORK_ID:"GET_NETWORK_ID",GET_ADDRESS:"GET_ADDRESS",GET_REWARD_ADDRESS:"GET_REWARD_ADDRESS",GET_BALANCE:"GET_BALANCE",SEND_TRANSACTION:"SEND_TRANSACTION",DELEGATE:"DELEGATE",GET_TRANSACTION_STATUS:"GET_TRANSACTION_STATUS",SIGN_DATA:"SIGN_DATA",ON_NETWORK_CHANGE:"ON_NETWORK_CHANGE",ON_ACCOUNT_CHANGE:"ON_ACCOUNT_CHANGE",CIP_GET_UTXOS:"CIP_GET_UTXOS",CIP_GET_BALANCE:"CIP_GET_BALANCE",CIP_GET_USED_ADDRESSES:"CIP_GET_USED_ADDRESSES",CIP_GET_UNUSED_ADDRESSES:"CIP_GET_UNUSED_ADDRESSES",CIP_GET_CHANGE_ADDRESS:"CIP_GET_CHANGE_ADDRESS",CIP_GET_REWARD_ADDRESSES:"CIP_GET_REWARD_ADDRESSES",CIP_GET_COLLATERAL:"CIP_GET_COLLATERAL",CIP95_GET_PUB_DREP_KEY:"CIP95_GET_PUB_DREP_KEY",CIP95_GET_REGISTERED_PUB_STAKEKEYS:"CIP95_GET_REGISTERED_PUB_STAKEKEYS",CIP95_GET_UNREGISTERED_PUB_STAKEKEYS:"CIP95_GET_UNREGISTERED_PUB_STAKEKEYS",CIP_SIGN_TRX:"CIP_SIGN_TRX",CIP_SIGN_TRXS:"CIP_SIGN_TRXS",CIP_SUBMIT_TRX:"CIP_SUBMIT_TRX"},TyphonEvents={accountChanged:"accountChanged",networkChanged:"networkChanged"};let typhonwalletDappConnectorEventCallbackFunctions={},isAccountChanged=!1;window.addEventListener("message",(function(e){const n=e.data;if(typhonwalletDappConnectorEventCallbackFunctions[n.REQUEST_ID]&&n.SENDER===SENDER.ContentScript){const e={data:n.DATA};typhonwalletDappConnectorEventCallbackFunctions[n.REQUEST_ID](e)}}));const typhonwalletDappConnectorMethods={enable:async()=>{const e=(new Date).valueOf().toString().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.ENABLE;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},window.origin)}))},isEnabled:async()=>{const e=(new Date).valueOf().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.IS_ENABLED;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},window.origin)}))},getNetworkId:async()=>{const e=(new Date).valueOf().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.GET_NETWORK_ID;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},window.origin)}))},getBalance:async()=>{const e=(new Date).valueOf().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.GET_BALANCE;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},"*")}))},getAddress:async()=>{const e=(new Date).valueOf().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.GET_ADDRESS;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},"*")}))},getRewardAddress:async()=>{const e=(new Date).valueOf().toString();return new Promise((n=>{const t=WINDOW_COMMUNICATION_METHODS.GET_REWARD_ADDRESS;function E(o){const s=o.data;s.EVENT===t&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==e&&(n(s.DATA),window.removeEventListener("message",E))}window.addEventListener("message",E),window.postMessage({SENDER:SENDER.WebPage,EVENT:t,REQUEST_ID:e},"*")}))},paymentTransaction:async e=>new Promise((n=>{const t=(new Date).valueOf().toString(),E=WINDOW_COMMUNICATION_METHODS.SEND_TRANSACTION;function o(e){const s=e.data;s.EVENT===E&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==t&&(n(s.DATA),window.removeEventListener("message",o))}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,DATA:e,REQUEST_ID:t},"*")})),delegationTransaction:async e=>new Promise((n=>{const t=(new Date).valueOf().toString(),E=WINDOW_COMMUNICATION_METHODS.DELEGATE;function o(e){const s=e.data;s.EVENT===E&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==t&&(n(s.DATA),window.removeEventListener("message",o))}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,DATA:e,REQUEST_ID:t},"*")})),getTransactionStatus:async e=>new Promise((n=>{const t=(new Date).valueOf().toString(),E=WINDOW_COMMUNICATION_METHODS.GET_TRANSACTION_STATUS;function o(e){const s=e.data;s.EVENT===E&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==t&&(n(s.DATA),window.removeEventListener("message",o))}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,DATA:e,REQUEST_ID:t},"*")})),on:(e,n)=>{const t=(new Date).valueOf().toString();return new Promise((E=>{let o;if(e==TyphonEvents.accountChanged)o=WINDOW_COMMUNICATION_METHODS.ON_ACCOUNT_CHANGE;else{if(e!=TyphonEvents.networkChanged){const e={status:!1,reason:DAPP_METHOD_ERROR_REASON.ERROR,error:"unknown event"};return E(e)}o=WINDOW_COMMUNICATION_METHODS.ON_NETWORK_CHANGE}function s(e){const a=e.data;if(a.EVENT===o&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==t){const e=a.DATA;e.status&&(typhonwalletDappConnectorEventCallbackFunctions[t]=n),E(e),window.removeEventListener("message",s)}}window.addEventListener("message",s),window.postMessage({SENDER:SENDER.WebPage,EVENT:o,REQUEST_ID:t},"*")}))},signData:async e=>new Promise((n=>{const t=(new Date).valueOf().toString(),E=WINDOW_COMMUNICATION_METHODS.SIGN_DATA;function o(e){const s=e.data;s.EVENT===E&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==t&&(s.DATA.status&&(s.DATA.data=s.DATA.data.signature),n(s.DATA),window.removeEventListener("message",o))}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,DATA:e,REQUEST_ID:t},"*")})),signDataForCIP30:async e=>new Promise((n=>{const t=(new Date).valueOf().toString(),E=WINDOW_COMMUNICATION_METHODS.SIGN_DATA;function o(e){const s=e.data;s.EVENT===E&&s.SENDER===SENDER.ContentScript&&s.REQUEST_ID==t&&(n(s.DATA),window.removeEventListener("message",o))}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,DATA:e,REQUEST_ID:t},"*")}))};function handleAccountChangeError(){if(isAccountChanged)throw{code:DAPP_METHOD_ERROR_CODE.ACCOUNT_CHANGE,info:"Account changed"}}const typhonCIP30APIObject={getNetworkId:async()=>{handleAccountChangeError();const e=await typhonwalletDappConnectorMethods.getNetworkId();if(e.status)return e.data;throw{code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}},getUtxos:async(e,n)=>{handleAccountChangeError();const t=(new Date).valueOf().toString().toString();return new Promise(((E,o)=>{const s=WINDOW_COMMUNICATION_METHODS.CIP_GET_UTXOS;function a(e){const n=e.data;if(n.EVENT===s&&n.SENDER===SENDER.ContentScript&&n.REQUEST_ID==t){const e=n.DATA;e.status?E(e.data):o({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",a)}}window.addEventListener("message",a),window.postMessage({SENDER:SENDER.WebPage,EVENT:s,REQUEST_ID:t,DATA:{amount:e,pagination:n}},window.origin)}))},getCollateral:async e=>{handleAccountChangeError();const n=(new Date).valueOf().toString().toString();return new Promise(((t,E)=>{const o=WINDOW_COMMUNICATION_METHODS.CIP_GET_COLLATERAL;function s(e){const a=e.data;if(a.EVENT===o&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==n){const e=a.DATA;e.status?t(e.data):E({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",s)}}window.addEventListener("message",s),window.postMessage({SENDER:SENDER.WebPage,EVENT:o,REQUEST_ID:n,DATA:e},window.origin)}))},getBalance:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP_GET_BALANCE;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getUsedAddresses:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP_GET_USED_ADDRESSES;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getUnusedAddresses:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP_GET_UNUSED_ADDRESSES;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getChangeAddress:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP_GET_CHANGE_ADDRESS;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getRewardAddresses:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP_GET_REWARD_ADDRESSES;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},signTx:async(e,n=!1)=>{handleAccountChangeError();const t=(new Date).valueOf().toString().toString();return new Promise(((E,o)=>{const s=WINDOW_COMMUNICATION_METHODS.CIP_SIGN_TRX;function a(e){const n=e.data;if(n.EVENT===s&&n.SENDER===SENDER.ContentScript&&n.REQUEST_ID==t){const e=n.DATA;if(e.status)E(e.data);else{const n={INVALID_REQUEST:-1,ERROR:-2,ABORT:2,REJECT:2,ProofGeneration:1};let t=-2,E="";e.error&&"string"!=typeof e.error?e.error&&e.error.code&&(t=n[e.error.code],E=e.error.message):(t=n[e.reason],E=e.error),o({code:t,info:E})}window.removeEventListener("message",a)}}window.addEventListener("message",a),window.postMessage({SENDER:SENDER.WebPage,EVENT:s,REQUEST_ID:t,DATA:{tx:e,partialSign:n}},window.origin)}))},signTxs:async e=>{handleAccountChangeError();const n=(new Date).valueOf().toString().toString();return new Promise(((t,E)=>{const o=WINDOW_COMMUNICATION_METHODS.CIP_SIGN_TRXS;function s(e){const a=e.data;if(a.EVENT===o&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==n){const e=a.DATA;if(e.status)t(e.data);else{const n={INVALID_REQUEST:-1,ERROR:-2,ABORT:2,REJECT:2,ProofGeneration:1};let t=-2,o="";e.error&&"string"!=typeof e.error?e.error&&e.error.code&&(t=n[e.error.code],o=e.error.message):(t=n[e.reason],o=e.error),E({code:t,info:o})}window.removeEventListener("message",s)}}window.addEventListener("message",s),window.postMessage({SENDER:SENDER.WebPage,EVENT:o,REQUEST_ID:n,DATA:e},window.origin)}))},submitTx:async e=>{handleAccountChangeError();const n=(new Date).valueOf().toString().toString();return new Promise(((t,E)=>{const o=WINDOW_COMMUNICATION_METHODS.CIP_SUBMIT_TRX;function s(e){const a=e.data;if(a.EVENT===o&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==n){const e=a.DATA;if(e.status)t(e.data);else{const n={INVALID_REQUEST:-1,ERROR:-2,ABORT:-3,REJECT:-3,Refused:1,Failure:2};let t=-2,o="";e.error&&"string"!=typeof e.error?e.error&&e.error.code&&(t=n[e.error.code],o=e.error.message):(t=n[e.reason],o=e.error),E({code:t,info:o})}window.removeEventListener("message",s)}}window.addEventListener("message",s),window.postMessage({SENDER:SENDER.WebPage,EVENT:o,REQUEST_ID:n,DATA:{tx:e}},window.origin)}))},signData:async(e,n)=>{handleAccountChangeError();const t=await typhonwalletDappConnectorMethods.signDataForCIP30({address:e,data:n});if(t.status)return t.data;const E={INVALID_REQUEST:-1,ERROR:-2,ABORT:3,REJECT:3,InvalidData:-1,InvalidAddress:1};let o=-2,s="";throw t.error&&"string"!=typeof t.error?t.error.code&&(o=E[t.error.code],s=t.error.message):(o=E[t.reason],s=t.error),{code:o,info:s}}},cip95APIObject={getPubDRepKey:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP95_GET_PUB_DREP_KEY;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getRegisteredPubStakeKeys:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP95_GET_REGISTERED_PUB_STAKEKEYS;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},getUnregisteredPubStakeKeys:async()=>{handleAccountChangeError();const e=(new Date).valueOf().toString().toString();return new Promise(((n,t)=>{const E=WINDOW_COMMUNICATION_METHODS.CIP95_GET_UNREGISTERED_PUB_STAKEKEYS;function o(s){const a=s.data;if(a.EVENT===E&&a.SENDER===SENDER.ContentScript&&a.REQUEST_ID==e){const e=a.DATA;e.status?n(e.data):t({code:DAPP_METHOD_ERROR_CODE[e.reason],info:e.error}),window.removeEventListener("message",o)}}window.addEventListener("message",o),window.postMessage({SENDER:SENDER.WebPage,EVENT:E,REQUEST_ID:e},window.origin)}))},signData:typhonCIP30APIObject.signData},typhonwalletCIP30Methods={isEnabled:async()=>{handleAccountChangeError();const e=await typhonwalletDappConnectorMethods.isEnabled();return e.data},enable:async e=>{const n=await typhonwalletDappConnectorMethods.enable();if(n.status)return isAccountChanged=!1,typhonwalletDappConnectorEventCallbackFunctions={},setTimeout((()=>{typhonwalletDappConnectorMethods.on("networkChanged",(e=>{e.data?.status||(isAccountChanged=!0)})),typhonwalletDappConnectorMethods.on("accountChanged",(e=>{e.data?.status||(isAccountChanged=!0)}))}),3e3),e&&e.extensions&&e.extensions[0]&&95==e.extensions[0].cip?(typhonCIP30APIObject.getExtensions=async()=>[{cip:95}],{...typhonCIP30APIObject,cip95:cip95APIObject}):(typhonCIP30APIObject.getExtensions=async()=>[],typhonCIP30APIObject);throw{code:DAPP_METHOD_ERROR_CODE[n.reason]}}};window.cardano={...window.cardano||{},typhon:{enable:typhonwalletDappConnectorMethods.enable,isEnabled:typhonwalletDappConnectorMethods.isEnabled,getNetworkId:typhonwalletDappConnectorMethods.getNetworkId,name:document.currentScript?.getAttribute("name"),icon:document.currentScript?.getAttribute("icon"),version:document.currentScript?.getAttribute("version"),getBalance:typhonwalletDappConnectorMethods.getBalance,getAddress:typhonwalletDappConnectorMethods.getAddress,getRewardAddress:typhonwalletDappConnectorMethods.getRewardAddress,paymentTransaction:typhonwalletDappConnectorMethods.paymentTransaction,delegationTransaction:typhonwalletDappConnectorMethods.delegationTransaction,getTransactionStatus:typhonwalletDappConnectorMethods.getTransactionStatus,signData:typhonwalletDappConnectorMethods.signData,on:typhonwalletDappConnectorMethods.on},typhoncip30:{name:document.currentScript?.getAttribute("name"),icon:document.currentScript?.getAttribute("icon"),apiVersion:"0.1.0",enable:typhonwalletCIP30Methods.enable,isEnabled:typhonwalletCIP30Methods.isEnabled,supportedExtensions:[{cip:95}]}};