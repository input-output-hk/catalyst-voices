<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Implementation of the GET /health/started endpoint"><title>cat_gateway::service::api::health::started_get - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../../../static.files/rustdoc-c233d2bd.css"><meta name="rustdoc-vars" data-root-path="../../../../../" data-static-root-path="../../../../../static.files/" data-current-crate="cat_gateway" data-themes="" data-resource-suffix="" data-rustdoc-version="1.88.0-nightly (df35ff6c3 2025-04-23)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../../../../static.files/storage-4e99c027.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../../../static.files/main-7ef8a74a.js"></script><noscript><link rel="stylesheet" href="../../../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../../cat_gateway/index.html">cat_<wbr>gateway</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module started_<wbr>get</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#implementation-of-the-get-healthstarted-endpoint" title="Implementation of the GET /health/started endpoint">Implementation of the GET /health/started endpoint</a><ul><li><a href="#key-features" title="Key Features">Key Features</a></li><li><a href="#how-it-works" title="How It Works">How It Works</a></li><li><a href="#example-scenarios" title="Example Scenarios">Example Scenarios</a></li><li><a href="#notes" title="Notes">Notes</a></li></ul></li></ul><h3><a href="#enums">Module Items</a></h3><ul class="block"><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In cat_<wbr>gateway::<wbr>service::<wbr>api::<wbr>health</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../../../index.html">cat_gateway</a>::<wbr><a href="../../../index.html">service</a>::<wbr><a href="../../index.html">api</a>::<wbr><a href="../index.html">health</a></div><h1>Module <span>started_get</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../../../src/cat_gateway/service/api/health/started_get.rs.html#1-138">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="implementation-of-the-get-healthstarted-endpoint"><a class="doc-anchor" href="#implementation-of-the-get-healthstarted-endpoint">§</a>Implementation of the GET /health/started endpoint</h2>
<p>This module provides an HTTP endpoint to monitor the start of the Cat Gateway
service, which depends on multiple parameters. It uses atomic booleans to track the
status of the service and its dependencies.</p>
<h3 id="key-features"><a class="doc-anchor" href="#key-features">§</a>Key Features</h3>
<ol>
<li>
<p><strong>Atomic Booleans for Initialization</strong>:</p>
<ul>
<li><code>STARTED</code>: Indicates whether the service has fully initialized. It defaults to
<code>false</code> on startup and can only transition to <code>true</code> once all required conditions
are met. Once set to <code>true</code>, it cannot be changed back to <code>false</code>.</li>
<li><code>LIVE_INDEX_DB</code> and <code>LIVE_EVENT_DB</code>: Track the connection status of the Index DB
and Event DB, respectively. Both default to <code>false</code> on startup and are set to
<code>true</code> once a successful connection is established.</li>
<li>A third atomic boolean (e.g., <code>INITIAL_FOLLOWER_TIP_REACHED</code>) is used to track
whether the chain indexer has reached the tip of the chain for the first time.
This also defaults to <code>false</code> and is set to <code>true</code> once the condition is met.</li>
</ul>
</li>
<li>
<p><strong>Initialization Logic</strong>:</p>
<ul>
<li>On startup, the service attempts to connect to both databases (Index DB and Event
DB). It will keep retrying until both connections are successful. Once both
databases are connected, their respective flags (<code>LIVE_INDEX_DB</code> and
<code>LIVE_EVENT_DB</code>) are set to <code>true</code>.</li>
<li>The <code>STARTED</code> flag is set to <code>true</code> only when all three conditions are met
simultaneously:
<ol>
<li><code>LIVE_INDEX_DB</code> is <code>true</code>.</li>
<li><code>LIVE_EVENT_DB</code> is <code>true</code>.</li>
<li><code>INITIAL_FOLLOWER_TIP_REACHED</code> is <code>true</code>.</li>
</ol>
</li>
<li>Once <code>STARTED</code> is set to <code>true</code>, it cannot be changed back to <code>false</code>.</li>
</ul>
</li>
<li>
<p><strong>Response Logic</strong>:</p>
<ul>
<li>If <code>STARTED</code> is <code>true</code>, the endpoint returns a <code>204 No Content</code> response,
indicating that the service is fully initialized and operational.</li>
<li>If <code>STARTED</code> is <code>false</code>, the endpoint returns a <code>503 Service Unavailable</code>
response, indicating that the service is not yet ready to handle requests.</li>
</ul>
</li>
</ol>
<h3 id="how-it-works"><a class="doc-anchor" href="#how-it-works">§</a>How It Works</h3>
<ul>
<li>On startup, the service attempts to connect to the Index DB and Event DB. It retries
until both connections are successful. Once connected, their respective flags
(<code>LIVE_INDEX_DB</code> and <code>LIVE_EVENT_DB</code>) are set to <code>true</code>.</li>
<li>The chain indexer monitors the blockchain and sets <code>INITIAL_FOLLOWER_TIP_REACHED</code> to
<code>true</code> once it reaches the tip of the chain for the first time.</li>
<li>When all three flags (<code>LIVE_INDEX_DB</code>, <code>LIVE_EVENT_DB</code>, and
<code>INITIAL_FOLLOWER_TIP_REACHED</code>) are <code>true</code>, the <code>STARTED</code> flag is set to <code>true</code>.</li>
<li>Once <code>STARTED</code> is <code>true</code>, the endpoint will always respond with <code>204 No Content</code>.</li>
<li>If <code>STARTED</code> is <code>false</code>, the endpoint will respond with <code>503 Service Unavailable</code>.</li>
</ul>
<h3 id="example-scenarios"><a class="doc-anchor" href="#example-scenarios">§</a>Example Scenarios</h3>
<ol>
<li>
<p><strong>Startup Phase</strong>:</p>
<ul>
<li>The service is starting up.</li>
<li><code>LIVE_INDEX_DB</code>, <code>LIVE_EVENT_DB</code>, and <code>INITIAL_FOLLOWER_TIP_REACHED</code> are all
<code>false</code>.</li>
<li><code>STARTED</code> is <code>false</code>.</li>
<li>The endpoint returns <code>503 Service Unavailable</code>.</li>
</ul>
</li>
<li>
<p><strong>Databases Connected, Indexer Not Ready</strong>:</p>
<ul>
<li>The Index DB and Event DB are connected (<code>LIVE_INDEX_DB</code> and <code>LIVE_EVENT_DB</code> are
<code>true</code>).</li>
<li>The chain indexer has not yet reached the tip of the chain
(<code>INITIAL_FOLLOWER_TIP_REACHED</code> is <code>false</code>).</li>
<li><code>STARTED</code> is <code>false</code>.</li>
<li>The endpoint returns <code>503 Service Unavailable</code>.</li>
</ul>
</li>
<li>
<p><strong>All Conditions Met</strong>:</p>
<ul>
<li>The Index DB and Event DB are connected (<code>LIVE_INDEX_DB</code> and <code>LIVE_EVENT_DB</code> are
<code>true</code>).</li>
<li>The chain indexer has reached the tip of the chain
(<code>INITIAL_FOLLOWER_TIP_REACHED</code> is <code>true</code>).</li>
<li><code>STARTED</code> is set to <code>true</code>.</li>
<li>The endpoint returns <code>204 No Content</code>.</li>
</ul>
</li>
<li>
<p><strong>After Initialization</strong>:</p>
<ul>
<li>All flags (<code>LIVE_INDEX_DB</code>, <code>LIVE_EVENT_DB</code>, <code>INITIAL_FOLLOWER_TIP_REACHED</code>, and
<code>STARTED</code>) are <code>true</code>.</li>
<li>The endpoint continues to return <code>204 No Content</code>.</li>
</ul>
</li>
</ol>
<h3 id="notes"><a class="doc-anchor" href="#notes">§</a>Notes</h3>
<ul>
<li>All booleans are atomic, meaning they are thread-safe and can be accessed
concurrently without issues.</li>
<li>Once <code>STARTED</code> is set to <code>true</code>, it cannot be reverted, ensuring that the service
remains in a consistent state after initialization.</li>
</ul>
<p>This endpoint is useful for monitoring the initialization status of a service that
depends on multiple external systems, ensuring that the service only becomes available
once all dependencies are ready.</p>
</div></details><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.Responses.html" title="enum cat_gateway::service::api::health::started_get::Responses">Responses</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>Endpoint responses.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.endpoint.html" title="fn cat_gateway::service::api::health::started_get::endpoint">endpoint</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>GET /health/started</dd></dl><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><dl class="item-table"><dt><a class="type" href="type.AllResponses.html" title="type cat_gateway::service::api::health::started_get::AllResponses">AllResponses</a><span title="Restricted Visibility">&nbsp;🔒</span> </dt><dd>All responses.</dd></dl></section></div></main></body></html>